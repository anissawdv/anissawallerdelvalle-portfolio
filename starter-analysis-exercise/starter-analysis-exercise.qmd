---
title: "Data Analysis Assessment"
---


Load the needed packages. For this assignment, I used the dslabs package, the tidyverse package, and the ggplot2 package.


```{r}        
library("dslabs")
library("tidyverse")
library("ggplot2")
```


Running the next command in the R console to seek information/assistance on gapminder.


```{r}        
# help(gapminder)
```


The str() function in R is short for structure. Running this command enables users to display the internal structure of an R object. I will run this command to display the structure of the gapminder dataset.


```{r}        
# display structure of dataset
str(gapminder)
```

The summary command in R produces summary statistics for a given dataset or vector. I will obtain a summary of the data.


```{r}
# obtain summary          
summary(gapminder)
```

The class() function in R determines the class (i.e., data type or structure) of an object. I will determine the type of object gapminder is.


```{r}        
# determine object type
class(gapminder)
```

I will write code that assigns only the African countries to a new object called africadata.

```{r}
# assign African countries to new object          
africadata <- gapminder %>%
     filter(continent == "Africa")
```


-   \<- is an assignment operator. It will assign the filtered data to a new object, which I have named africadata.


-   gapminder is the dataset being used. %\>% is a pipe operator. It will take the output of one function and use it as the input to the next function.


-   filter() is a function that selects a subset of rows from a dataset that met specific conditions. It is part of the tidyverse collection.


-   continent == "Africa" is the condition being used inside filter(). It will keep rows where the continent coloumn is equal to "Africa". Africa must be in quotes because it is a text string.


I will check the new data set using the str and summary functions.


```{r}        
str(africadata) # structure of data
```


```{r}
summary(africadata) # summary of data
```

I confirmed there are now 2,907 observations. Now, I will take the africadata object and create two new objects. One object will contain infant_mortality and life_expectancy data. The other will contain population and life_expectancy. I should have two objects with 2,907 observations and two variables.


I will generate an object with only infant_mortality and life_expectancy


```{r}
# create object with only infant mortality and life expectancy          
africa_infantmort_lifeexp <- africadata %>%
     select(infant_mortality, life_expectancy)
```


-   africa_infantmort_lifeexp will be the new object with only infant_mortality and life_expectancy.


-   \<- is an assignment operator and will assign the filtered data to the new object, africa_infantmort_lifeexp.


-   africadata is the dataset being used.


-   select() is a function that will grab a specific coloumn(s) from a dataset, enabling users to create a new dataset that contains only the columns selected.


```{r}
# displau structure
str(africa_infantmort_lifeexp)
```


```{r}
# obtain summary
summary(africa_infantmort_lifeexp)
```


I have confirmed that the above dataset, africa_infantmort_lifeexp, has 2,907 observations of 2 variables. I will now repeat the process described above to generate the second object with population and life_expectancy


```{r}
# create object with population and life expectancy          
africa_pop_lifeexp <- africadata %>%
     select(population, life_expectancy)
```


```{r}
# display structure of data
str(africa_pop_lifeexp)
```


```{r}
# obtain summary of data
summary(africa_pop_lifeexp)
```

I have confirmed that the above dataset, africa_pop_lifeexp, has 2,907 observations of 2 variables.


I will now plot life expectancy as a function of infant mortality. I expect to see a negative correlation between infant mortality and life expectancy.


```{r}
# plot life expectancy as a function of infant mortality        
ggplot(africa_infantmort_lifeexp, aes(x = infant_mortality, y = life_expectancy)) +
     geom_point() +
     labs(
          title = "Life Expectancy vs Infant Mortality in Africa",
          x = "Infant Mortality",
          y = "Life Expectancy" 
)
```


-   ggplot() is a function used to initialize a plot object. components must be added using the + operator.


-   africa_infantmort_lifeexp is the dataset I want to plot.


-   aes() is a function that links data variables to aesthetics, like the x and y position on a graph.


-   geom_point() is a function used to add individual points to a plot.


-   labs() is a function used to modify various labels of a plot.




226 rows containing missing values or values outside of the scale range were removed.


I have plotted life expectancy as a function of infant mortality. I saw a negative correlation between infant mortality and life expectancy.


I will now plot life expectancy as a function of population size. in this plot, the x-axis will be set to log scale.


```{r}
# plot life expectancy as a function of population size
# set x-axis to log scale          
ggplot(africa_pop_lifeexp, aes(x = population, y = life_expectancy)) +
     geom_point() +
     scale_x_log10() +
     labs( 
          title = "Life Expectancy vs Population in Africa", 
          x = "Population (log scale)", y = "Life Expectancy" 
          )
```


-   scale_x_log10() is a function that transforms the x-axis of a plot to a base-10 logarithmic scale.



51 rows containing missing values or values outside of the scale range were removed.


I have plotted life expectancy as a function of population size. I saw a positive correlation between population size and life expectancy.


In both plots, there are 'streaks' of data. I believe that this due to the fact that I am looking at data for each individual country in africa over several decades (1960 - 2016).


As mentioned previously, 226 rows containing missing values or values outside of the scale range were removed from the first plot looking at life expectancy as a function of infant mortality. I will now figure out which years have missing data for infant mortality.


```{r}
# determine the number of countries that are missing data on infant mortality per year          
africadata %>%
     group_by(year) %>%
     summarise(missing_infant = sum(is.na(infant_mortality))) %>%
     arrange(year)
```


-   africadata is the dataset that will be used.


-   group_by() is a function that organizes data into groups. I will group the data by year.


-   summarise() is a function that summarizes a dataset into a single value.


-   is.na() is a function that identifies missing values in an object. Here, the object is infant_mortality.


-   sum() is a function that adds the number of true values. This will count the number of countries in africa that are missing infant data mortality for each year.


-   missing_infant is the name given to the column that will store the counts obtained from the sum(...) function.


I currently only see the first 10 rows. To see the rest, I will first make missing_infant an object, and then print all rows.


```{r}        
# see all years
missing_by_year <- africadata %>% 
     group_by(year) %>%
     summarise(missing_infant = sum(is.na(infant_mortality))) %>%
     arrange(year)
```

```{r}
# print
print(missing_by_year, n = Inf)
```


I can see that all countries in Africa reported infant mortality between the years 1982 - 2015. I will now take a look at data from the year 2000 only. I expect to end up with 51 observations and 9 variables.



```{r}
# use data only from year 2000          
africa_yr2000 <- africadata %>%
     filter(year == 2000)
```

```{r}
str(africa_yr2000)
```

```{r}
summary(africa_yr2000)
```


I can see 51 observations of 9 variables. I will now make the same plots as above again, this time for the year 2000. I expect to see a negative correlation between infant mortality and life expectancy.


```{r}
# plot life expectancy as function of infant mortality          
ggplot(africa_yr2000, aes(x = infant_mortality, y = life_expectancy)) +
     geom_point() +
     labs(
          title = "Life Expectancy vs Infant Mortality in Africa (2000)",
          x = "Infant Mortality",
          y = "Life Expectancy" 
)
```

I will now make the same plots as above again, this time for the year 2000. I expect to see no noticeable correlation between population size and life expectancy.


```{r}
# plot population size as function of life expectancy          
ggplot(africa_yr2000, aes(x = population, y = life_expectancy)) +
     geom_point() +
     scale_x_log10() +
     labs(
          title = "Life Expectancy vs Population in Africa (2000)",
          x = "Population (log scale)",
          y = "Life Expectancy"
)
```

I will fit a linear model to this data. I will fit life expectancy as the outcome and infant mortality as the predictor. I will save the result into an object and view the results of this model.


-   lm() is a function used to fit linear models.


-   The output is on the left-hand side of \~.


-   The predictor is on the right-hand side of \~.


-   data = africa_yr2000 is the dataset being used. fit1 is the name of the object being created.


```{r}
# fit linear model to life expectancy and infant mortality data          
fit1 <- lm(life_expectancy ~ infant_mortality, data = africa_yr2000)
summary(fit1)
```


The y-intercept of the regression line is 71.29331. This is the predicted value of life expectancy when infant mortality = 0. The slope is -0.18916. Life expectancy decreases by 0.18916 years with each infant mortality. The slope is statistically significant (p \< 0.001). In sum, this means there is a strong negative correlation between infant mortality and life expectancy, with high infant mortality predicting low life expectancy.


I will now repeat with population size as the predictor variable and life expectancy as the outcome.


```{r}
# fit linear model to life expectancy and population size          
fit2 <- lm(life_expectancy ~ population, data = africa_yr2000)
summary(fit2)
```


The y-intercept of the regression line is 55.93. This is the predicted value of life expectancy when population = 0. The slope is 2.756e-08. Life expectancy increases by 2.756e-08 years with each additional person. The slope is not statistically significant. Put together, this means that population size is not a predictor of life expectancy in the year 2000 for countries in Africa.

```{r}
# This part was contributed by Aylla von Ermland

# Load libraries
library("dslabs")
library("dplyr")
library("ggplot2")
library("pheatmap")

# Load dataset
data("tissue_gene_expression")

x <- tissue_gene_expression$x
y <- tissue_gene_expression$y

# Check structure
str(tissue_gene_expression)

dim(x)                         

summary(tissue_gene_expression)

#find what are the tissue types
table(y)                          
```

```{r}
# View the first 10 rows (samples) of the expression matrix to have an idea how the data looks like:
head(tissue_gene_expression$x, 10)
```

 After exploring the data, I have found 94500 numbers in matrix = 189 samples × 500 genes. 
 Next, I decided to perform the classical PCA analysis and plots for gene expression data:

```{r}

pca <- prcomp(x)                  
pca_data <- data.frame(
  PC1 = pca$x[,1],
  PC2 = pca$x[,2],
  tissue = y
)

# Plot PC1 vs PC2
ggplot(pca_data, aes(x = PC1, y = PC2, color = tissue)) +
  geom_point(size = 1.5) +
  labs(title = "PCA of gene expression", x = "PC1", y = "PC2") +
  theme_minimal()
```

I chose to explore basic tissue-specific expression patterns. Specifically, I addressed whether brain tissues (e.g., cerebellum and hippocampus) share more highly expressed genes with each other than they do with non-brain tissues.

```{r}

# AI Disclosure: I used ChatGPT in this step to review the code for generating the matrix and converting expression matrix (189 samples × 500 genes) into a data frame 'as.data.frame' : 

# For each gene, I computed average expression across all samples within each tissue
tissue_avg_matrix <- do.call(rbind, lapply(split(as.data.frame(x), y), colMeans))

# Compute correlation matrix between tissues
cor_matrix <- cor(t(tissue_avg_matrix))  # genes as rows

# Assign tissue names to rows and columns
tissue_names <- rownames(tissue_avg_matrix)
rownames(cor_matrix) <- colnames(cor_matrix) <- tissue_names

# Plot correlation heatmap
pheatmap(cor_matrix,
         main = "Correlation of average gene expression",
         clustering_distance_rows = "correlation",
         clustering_distance_cols = "correlation",
         display_numbers = TRUE)

```

Last, I tried to stistically test weather brain tissues share a higher number of highly expressed genes compared to other non-brain tissues. 

Question: is the average correlation between brain and non-brain tissues statistically lower than the correlation between the two brain tissues? 

Here I will be testing whether a set of correlations (brain–non-brain) is statistically lower on average than a reference value (brain–brain).

```{r}
# Do brain tissues exhibit more similar gene expression patterns with each other than they do with non-brain tissues?
brain_tissues <- c("cerebellum", "hippocampus")
non_brain_tissues <- setdiff(tissue_names, brain_tissues)

# Correlation between brain tissues
brain_brain_cor <- cor_matrix["cerebellum", "hippocampus"]

# Correlations between each brain tissue and all non-brain tissues
brain_non_cor <- c(
  cor_matrix["cerebellum", non_brain_tissues],
  cor_matrix["hippocampus", non_brain_tissues]
)

# One-sample t-test: is brain–non-brain correlation < brain–brain correlation?
t.test(brain_non_cor, mu = brain_brain_cor, alternative = "less")

```

